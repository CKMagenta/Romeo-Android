<!doctype html>
<html>
<head>
<meta charset="utf-8">
<script src="lib/plugin/jquery-1.9.1.min.js"></script>
<script src="lib/plugin/d3.v3.min.js"></script>
<script src="lib/plugin/json2.js"></script>
<script src="lib/plugin/underscore-min.js"></script>
<script src="lib/plugin/excanvas.js"></script>
<script src="lib/plugin/jit.js"></script>
</head>

<body>
<div id="frame"></div>    
<script>
/*
var labelType, useGradients, nativeTextSupport, animate;

(function() {
  var ua = navigator.userAgent;
  var iStuff = ua.match(/iPhone/i) || ua.match(/iPad/i);
  var typeOfCanvas = typeof HTMLCanvasElement;
  var nativeCanvasSupport = (typeOfCanvas == 'object' || typeOfCanvas == 'function');
  textSupport = nativeCanvasSupport 
        && (typeof document.createElement('canvas').getContext('2d').fillText == 'function');
  //I'm setting this based on the fact that ExCanvas provides text support for IE
  //and that as of today iPhone/iPad current text support is lame
  labelType = (!nativeCanvasSupport || (textSupport && !iStuff))? 'Native' : 'HTML';
  nativeTextSupport = labelType == 'Native';
  useGradients = nativeCanvasSupport;
  animate = !(iStuff || !nativeCanvasSupport);
})();
*/
/*
var Log = {
  elem: false,
  write: function(text){
    if (!this.elem) 
      this.elem = document.getElementById('log');
    this.elem.innerHTML = text;
    this.elem.style.left = (500 - this.elem.offsetWidth / 2) + 'px';
  }
};
*/
/*
$(document).ready(function(e) {
	var voteJSON = "[1,1,1]";
	makeGraph(voteJSON);
});
*/
 
function makeGraph(voteJSON, width, height) {
	
	var DEFAULT_WIDTH = 500;
	var DEFAULT_HEIGHT = 500;
	
	width 	= width 	|| 	DEFAULT_WIDTH;
	height 	= height 	|| 	DEFAULT_HEIGHT;
	
	$("#frame").width(width).height(height);
	// "[5,4,3]" (String)
	var voteParsed = JSON.parse(voteJSON);
	// [5,4,3] (ArrayObject)
	
	var vote = Array();
	for(var i=0; i<voteParsed.length; i++) {
		vote.push({"label":"Options"+i, "values" : voteParsed[i]});
	}
	
	render(vote);
}

function render(vote) {
	var colors = ["#AF0452", "#FF8500", "#008196", "#002787", "#4903C7"];
	var data = {
		'color'	 :	colors,
	    'values' :	vote
	    };
	
	    //init PieChart
	    pieChart = new $jit.PieChart({
	        injectInto: 'frame',
	        animate: true,
	        offset: 20,
	        sliceOffset: 0,
	        type:'stacked',
	        updateHeights:false,
	        showLabels:false
	    });
	    
	    //load JSON data.
	    pieChart.loadJSON(data);
}
</script>

</body>
</html>
